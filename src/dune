(ocamllex luafloat luascanner)

(rule
 (targets luaparser.ml)
 (deps
  (:parser luaparser.mly))
 (action
  (chdir
   %{workspace_root}
   (run %{bin:ocamlyacc} %{parser}))))

;; this is not generated by ocamlyacc because there is a custom mli file which
;; declares the parser functor

(rule
 (target luaparser.mli)
 (deps luaparser.mlii)
 (action
  (copy %{deps} %{target})))

(library
 (name lua)
 (libraries unix)
 ; sadness
 (wrapped false)
 (public_name lua-ml))
